:PROPERTIES:
:ID:       73628fec-e69a-4f04-b9d9-f07c3fe7eedf
:END:
#+title: ift2245-disques
#+STARTUP: latexpreview inlineimages
#+date: [2022-04-01 Fri 23:51]

* Structure d'un disque

Les disques magnétiques fournissent l'essentiel du stockage secondaire des ordinateurs modernes

- *Transfer rate* (taux de transfert) ($R_s$) - Taux auquel les données sont transferré entre le lecteur et l’ordinateur
- *Seek time* (temps de recherche) ($T_a$) - Temps de déplacement de la tête
- *Rotational latency* (latence de rotation) ($T_l$) - Temps de déplacement du bloc par rotation

Têtes volent sur les plateaux
- *Head crash* (accident de tête) - Résultat de la tête entrant en contact avec la surface du disque (pas bon!)

- *Track* (Piste) $\equiv$ *Platter* (plateau) $\cap$ *cylinder* (cylindre)

* Performance des disques

*IOPS* (I/O Operations per second) $\Rightarrow$ Métrique généralement utilisée pour décrire la capacité d'un périphérique de stockage à traiter des demandes d'entrée-sortie aléatoires
- Une "opération" est équivalente au transfert d'un "bloc" entier
- *Block size* (taille d’un bloc) - Quantité de données transférées pendant une opération d'I/O ($N$ secteurs: ex.: secteur = 512 B, bloc = 4 KB)
*Throughput* (débit) $\Rightarrow$ nombre de bytes transférés par unité de temps
*Response time* (temps de réponse) ($T_r$) $\Rightarrow$ Temps nécessaire pour traiter une demande d’opération d’I/O
*Transfer time* ($T_t$) $\Rightarrow$ Temps pour transférer un bloc

IOPS $=$ throughput $/$ block_size
$T_{io} = T_a + T_l + T_t =$ 1 $/$ IOP
$T_t =$  block_size $/ R_s$
throughput = $R_s \cdot T_t /T_io$
Cas optimal: $T_r = T_{io}$

* Disques magnétique

| Spindle [rpm] | Average latency [ms] |
|---------------+----------------------|
|          4200 |                 7.14 |
|          5400 |                 5.56 |
|          7200 |                 4.17 |
|         10000 |                    3 |
|         15000 |                    2 |

Capacité de 30 GB à 3 TB, en blocs de 4 KB
Performance:
- Taux de transfert théorique - 6 Gbits/s
- Taux de transfert réel - ~ 1 Gbits/s
- Seek time - 3ms à 12 ms
- Latence rotationnelle basée sur la vitesse du spindle
  - Latence maximum - Temps pour 1 révolution $= 1/(\mathrm{RPM}/60)$
  - Latence moyenne - Temps pour 1/2 révolution

** Exemple de performance

Latence d'accès moyen = Temps d'accès moyen = Seek time moyen + Latence de rotation moyen
Temps moyen d'I/O $(T_{IO})$ = Temps d'accès moyen + (Montant à transferrer / Taut de transfert)
- Ex.: Temps moyen poiur transferrer un bloc de 4 KB à 7200 RPM avec 5 ms seek time moyen, 1 Gbits/s de taux de tansfert:

Note que $1 \mathrm{Gbits/s} = \frac{1}{8} \mathrm{GB/s} = (0.125 \times 1024 \times 1024) \mathrm{KB/s}$

\begin{align*}
T_{IO} = 5 \mathrm{ms} + \frac{1}{\mathrm{RPM / 60}} \times 1/2 + \frac{4 \mathrm{KB}}{131072} & = 9.1 \bar 6 + 0.030517578125 \\
& \approx 9.197 \mathrm{ms}
\end{align*}

* Structure du disque (contd...)

- Le SE ne voit qu’un tableau de $N$ blocs logiques de taille fixe
- Reçoit des requêtes de lecture et d'écriture sur les blocs
- Un accès séquentiels obtient de meilleures performances
- Vitesse linéaire constante vs. Vitesse angulaire constante

* Ordonnancement de disques

Le S/E est responsable de l'utilisation efficace du matériel
- Pour les unités de disque, cela signifie un temps d'accès rapide et bandwidth disque

Le but est de minimiser le "seek time"
- Le "seek time" est lié à la distance entre les blocs sur les disques (les déplacement de têtes)
- Un queue de requêtes par disque (dans le SE et/ou le disque)
- Si le queue est vide - pas de différence
- Sinon, choix d’algorithmes d’ordonnancement
